!function(e,t){"function"==typeof define&&define.amd?define(["module","exports"],t):"undefined"!=typeof exports?t(module,exports):(t(t={exports:{}},t.exports),e.MTautosize=t.exports)}(this,function(e,t){"use strict";var n,o,d="function"==typeof Map?new Map:(n=[],o=[],{has:function(e){return-1<n.indexOf(e)},get:function(e){return o[n.indexOf(e)]},set:function(e,t){-1===n.indexOf(e)&&(n.push(e),o.push(t))},delete:function(e){e=n.indexOf(e);-1<e&&(n.splice(e,1),o.splice(e,1))}}),u=function(e){return new Event(e,{bubbles:!0})};try{new Event("test")}catch(e){u=function(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!1),t}}function a(e){e=d.get(e);e&&e.destroy()}function i(e){e=d.get(e);e&&e.update()}var r=null;"undefined"==typeof window||"function"!=typeof window.getComputedStyle?((r=function(e){return e}).destroy=function(e){return e},r.update=function(e){return e}):((r=function(e,t){return e&&Array.prototype.forEach.call(e.length?e:[e],function(e){function o(e){var t=i.style.width;i.style.width="0px",i.offsetWidth,i.style.width=t,i.style.overflowY=e}function a(){var e,t;0!==i.scrollHeight&&(e=function(e){for(var t=[];e&&e.parentNode&&e.parentNode instanceof Element;)e.parentNode.scrollTop&&t.push({node:e.parentNode,scrollTop:e.parentNode.scrollTop}),e=e.parentNode;return t}(i),t=document.documentElement&&document.documentElement.scrollTop,i.style.height="",i.style.height=i.scrollHeight+r+"px",s=i.clientWidth,e.forEach(function(e){e.node.scrollTop=e.scrollTop}),t&&(document.documentElement.scrollTop=t))}function n(){a();var e=Math.round(parseFloat(i.style.height)),t=window.getComputedStyle(i,null),n="content-box"===t.boxSizing?Math.round(parseFloat(t.height)):i.offsetHeight;if(n!==e?"hidden"===t.overflowY&&(o("scroll"),a(),n="content-box"===t.boxSizing?Math.round(parseFloat(window.getComputedStyle(i,null).height)):i.offsetHeight):"hidden"!==t.overflowY&&(o("hidden"),a(),n="content-box"===t.boxSizing?Math.round(parseFloat(window.getComputedStyle(i,null).height)):i.offsetHeight),l!==n){l=n;n=u("autosize:resized");try{i.dispatchEvent(n)}catch(e){}}}var i,r,s,l,f,c;(i=e)&&i.nodeName&&"TEXTAREA"===i.nodeName&&!d.has(i)&&(l=s=r=null,f=function(){i.clientWidth!==s&&n()},c=function(t){window.removeEventListener("resize",f,!1),i.removeEventListener("input",n,!1),i.removeEventListener("keyup",n,!1),i.removeEventListener("autosize:destroy",c,!1),i.removeEventListener("autosize:update",n,!1),Object.keys(t).forEach(function(e){i.style[e]=t[e]}),d.delete(i)}.bind(i,{height:i.style.height,resize:i.style.resize,overflowY:i.style.overflowY,overflowX:i.style.overflowX,wordWrap:i.style.wordWrap}),i.addEventListener("autosize:destroy",c,!1),"onpropertychange"in i&&"oninput"in i&&i.addEventListener("keyup",n,!1),window.addEventListener("resize",f,!1),i.addEventListener("input",n,!1),i.addEventListener("autosize:update",n,!1),i.style.overflowX="hidden",i.style.wordWrap="break-word",d.set(i,{destroy:c,update:n}),"vertical"===(e=window.getComputedStyle(i,null)).resize?i.style.resize="none":"both"===e.resize&&(i.style.resize="horizontal"),r="content-box"===e.boxSizing?-(parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)):parseFloat(e.borderTopWidth)+parseFloat(e.borderBottomWidth),isNaN(r)&&(r=0),n())}),e}).destroy=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],a),e},r.update=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],i),e}),t.default=r,e.exports=t.default});var MTWindow=!1;window.top.TvrMT?MTWindow=window.top:window.parent.TvrMT?MTWindow=window.parent:window.parent.parent&&window.parent.parent.TvrMT&&(MTWindow=window.parent.parent),jQuery(document).ready(function(b){var e=MTWindow.TvrMT,i=e.TvrUi,T=e.TvrCom,t=(e.tvrsprintf,MTWindow.TvrLang,e.mod.MTsave),n={query:"",category:{serif:1,"sans-serif":1,display:1,handwriting:1,monospace:1},sort:"popularity",subset:""},z={allFonts:{},filteredFonts:[],google:{url:"https://www.googleapis.com/webfonts/v1/webfonts?key=AIzaSyBY_w3-Yj6T54CQP5RNZrruBHEvwenEOmU",filters:b.extend(!0,{},n),adjustments:b.extend(!0,{},{preview_text:"sentence",custom_text:"",font_size:"",variant:"regular"}),pagination:{results_per_page:6,current_page:1,index:0,total_pages:0,total_fonts:0}},typekit:{},preview_text:{sentence:{text:"Grumpy wizards make toxic brew for the evil Queen and Jack.",font_size:32,line_height:1.1},paragraph:{text:"As the minuteness of the parts formed a great hindrance to my speed, I resolved, contrary to my first intention, to make the being of a gigantic stature; that is to say, about eight feet in height, and proportionably large. ",font_size:18,line_height:1.44},alphabet:{text:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghjklmnopqrstuvwxyz ‘?’“!”(%)[#]{@}/&\\<-+÷×=>®©$€£¥¢:;,.*",font_size:24,line_height:1.33},numerals:{text:"1234567890",font_size:58,line_height:1.1},custom:{text:"",font_size:24,line_height:1.33}},init:function(){this.get_font_settings(),this.bind_events(),this.update_filters(),this.fetch_fonts()},bind_events:function(){b("#tvr-fonts").on("change","select",function(e){z.route_event(e,b(this))}).on("input propertychange","input, textarea",function(e){z.route_event(e,b(this))}).on("blur","textarea",function(e){z.route_event(e,b(this))}).on("click",function(e){z.route_event(e,b(this))})},route_event:function(e,t){switch(e.type){case"click":var n=b(e.target);switch(n.data("action")){case"pagination":z.change_pagination(n);break;case"toggle-category":T.toggle_radio_checkbox(n),z.filter_changed(n.prev(),"category");break;case"clear_filters":this.clear_filters(n);break;case"apply_to_all":this.apply_to_all(n);break;case"insert-font":this.insert_font(n);break;case"show-textarea":this.show_textarea(n)}break;case"blur":case"focusout":case"change":case"input":case"propertychange":var o=t,a=o.attr("name");switch(a){case"preview_text":case"variant":case"font_size":z.font_adjusted(o,a);break;case"current_page":z.change_pagination(o);break;case"query":case"sort":case"subset":z.filter_changed(o,a);break;case"font_textarea":"blur"===e.type||"focusout"===e.type?this.hide_textarea(o):z.font_adjusted(o,a)}}},get_font_settings:function(){i.pref&&i.pref.font_config.google&&(this.google=i.pref.font_config.google)},save_font_settings:function(){i.pref&&t.simple_ajax_request({url:i.ajaxUrl+"&save_font_config=google",type:"POST",sendData:t.serialized_data_with_single_key(JSON.stringify(this.google)),plus:"",minus:""})},update_filters:function(){var o=z.google.filters;b("#query-filter").find("input").val(o.query),b("#category-filter").find(".fake-checkbox").each(function(e){var t=b(this),n=t.prev().data("category");o.category[n]?T.check_fake(t):T.uncheck_fake(t)});for(var e=["sort","subset"],t=0;t<e.length;t++){var n=e[t];this.set_select_element(b("#"+n+"-filter"),o[n])}},set_select_element:function(e,t){var n=e.find("select");return(n=T.isDomEl(n)?n:e).find("option").filter(":selected").prop("selected",!1).end().filter('[value="'+t+'"]').prop("selected",!0).attr("selected","selected"),n},fetch_fonts:function(){b.ajax({type:"GET",url:z.google.url,data:z.resolve_api_data(z.google.filters),dataType:"jsonp",async:!0,timeout:i.tOut,error:function(e,t){z.handle_ajax_error(e,t)},success:function(e){z.allFonts=e,z.filter_fonts(),z.load_first_page()}})},show_clear_filters:function(){b("#clear-filters").addClass("show")},hide_clear_filters:function(){b("#clear-filters").removeClass("show")},clear_filters:function(){var e="popularity"!==this.google.filters.sort;this.google.filters=b.extend(!0,{},n),e&&this.fetch_fonts(),this.update_filters(),this.filter_fonts(),this.load_first_page()},show_apply_to_all:function(e){e.find(".apply-to-all").addClass("show")},apply_to_all:function(e){var t=this.google.adjustments,n=e.closest("li"),o=n.find("select[name=variant]").val(),e=n.data("item-number");t.preview_text=n.find("select[name=preview_text]").val(),t.font_size=n.find("input[name=font_size]").val(),t.custom_text="custom"===t.preview_text?n.find("textarea.font").val():"",this.update_display_fonts();n=(n=b("#gf-output").find("li[data-item-number="+e+"]")).find("select[name=variant]");this.set_select_element(n,o),z.font_adjusted(n,"variant")},getCaretPosition:function(e){var t,n,o=0;return window.getSelection?(t=window.getSelection()).rangeCount&&(n=t.getRangeAt(0)).commonAncestorContainer.parentNode==e&&(o=n.endOffset):document.selection&&document.selection.createRange&&(n=document.selection.createRange()).parentElement()==e&&(t=document.createElement("span"),e.insertBefore(t,e.firstChild),(e=n.duplicate()).moveToElementText(t),e.setEndPoint("EndToEnd",n),o=e.text.length),o},setSelectionRange:function(e,t,n){e.setSelectionRange?(e.focus(),e.setSelectionRange(t,n)):e.createTextRange&&((e=e.createTextRange()).collapse(!0),e.moveEnd("character",n),e.moveStart("character",t),e.select())},setCaretToPos:function(e,t){this.setSelectionRange(e,t,t)},show_textarea:function(e){var t=e.closest("li"),n=this.getCaretPosition(e[0]),e=t.find("textarea");t.addClass("show-textarea"),MTautosize.update(e),this.setCaretToPos(e[0],n)},hide_textarea:function(e){e.closest("li").removeClass("show-textarea")},font_adjusted:function(e,t){var n=this.google.adjustments,o=(this.google.filters,e.val()),a=e.closest("li"),i=a.find(".font");switch(t){case"preview_text":var r=this.preview_text[o],s=this.get_preview_text(r,n,o);i.text(s).val(s).css({"font-size":r.font_size+"px","line-height":r.line_height}),a.find(".font_size-adjustment").find("input").val(r.font_size);break;case"font_textarea":this.set_select_element(a.find(".preview_text-adjustment").find("select"),"custom"),i.filter("div").text(o);break;case"variant":s=o.match(/^(\d+)?\s?([a-z]+)?$/),r=s&&s[1]?s[1]:"normal",s=s&&s[2]?s[2]:"normal";return i.css({"font-weight":r,"font-style":s}),!0;case"font_size":i.css("font-size",o+"px")}"font_textarea"!==t&&MTautosize.update(i.filter("textarea")),this.show_apply_to_all(a)},filter_fonts:function(){var e,t=this.google.filters,n=this.allFonts.items,o=[],a=t.category,i=[],r=t.query.trim().toLowerCase();for(e in a)a.hasOwnProperty(e)&&a[e]&&i.push(e);for(var s=0;s<n.length;s++){var l=n[s],f=l.family.toLowerCase();t.query&&f.indexOf(r)<0||i.length<5&&!T.in_array(l.category,i)||t.subset&&!T.in_array(t.subset,l.subsets)||o.push(l)}n.length===o.length&&"popularity"===t.sort?this.hide_clear_filters():this.show_clear_filters(),this.filteredFonts=o},filter_changed:function(e,t){var n=this.google.filters,o=e.val(),a=e.closest(".font-filter");switch("category"!==t&&(n[t]=o),t){case"sort":return this.fetch_fonts(),!0;case"category":var i=n[t];a.find("input[type=checkbox]").each(function(e){var t=b(this),n=t.attr("name").match(/\[(.+)\]/)[1];i[n]=t.is(":checked")})}this.filter_fonts(),this.load_first_page()},change_pagination:function(e){var t,n=z.google.pagination,e=e.data("value"),o=(o=b("#current-font-page").val())?parseInt(o):1;switch(e){case"first":t=1;break;case"prev":t=o-1;break;case"manual":t=o;break;case"next":t=o+1;break;case"last":t=n.total_pages}!t||t<1?t=1:t>n.total_pages&&0<n.total_pages&&(t=n.total_pages),n.current_page=t,n.index=(t-1)*n.results_per_page,z.update_pagination(),z.update_display_fonts()},update_pagination:function(){var e=b("#controls"),t=b("#pagination"),n=z.google.pagination;n.total_fonts=this.filteredFonts.length,n.total_pages=Math.ceil(n.total_fonts/n.results_per_page),e.find(".font-count").text(n.total_fonts),t.find(".page-total").text(n.total_pages);e=b("#current-font-page");e.is(":focus")||e.val(n.current_page),t.find(".control-disabled").removeClass("control-disabled"),n.current_page<=1?t.find(".first-page, .prev-page").addClass("control-disabled"):n.current_page>=n.total_pages&&t.find(".gf-next-page, .gf-last-page").addClass("control-disabled")},load_first_page:function(){var e=b("#current-font-page");e.val(1),this.change_pagination(e)},get_preview_text:function(e,t,n){return"custom"===n?t.custom_text:e.text},update_display_fonts:function(){var e=b("#google-fonts"),t=[],n=z.google.pagination,o=z.google.adjustments,a=z.google.filters,i=n.index,r=n.index+n.results_per_page,s=this.preview_text[o.preview_text],l=this.get_preview_text(s,o,o.preview_text),n=o.font_size||s.font_size,f=this.filteredFonts.slice(i,r),c=b("<ul>"),d=b("#font-entry-template").find("li").clone();d.find(".font").text(l).val(l).css({"font-size":n+"px","line-height":s.line_height}).end().find(".font_size-adjustment").find("input").val(n),this.set_select_element(d.find(".preview_text-adjustment"),o.preview_text);for(var u=0;u<f.length;u++){for(var p=f[u],g=d.clone(!0,!0),h=g.find(".variant-adjustment").find("select"),_=p.variants,v="",m=0;m<_.length;m++){var y=_[m].replace(/italic/g," italic"),w=y,x="regular"===y?'selected="selected"':"";v+='<option value="'+(y=y.replace("regular","400"))+'"'+x+">"+w+"</option>"}h.html(v),_.length<=1&&h.prop("disabled",!0),g.attr("data-item-number",u).find(".font-name").text(p.family).end().find(".font").css("font-family",p.family).end().find(".use-font").data("use-font",p.family),c.append(g);p=p.variants.length?p.family+":"+p.variants.join(","):p.family;t.push(p)}o="//fonts.googleapis.com/css?family="+t.join("|").replace(/ /g,"+");o+=a.subset?"&subset="+a.subset:"",T.isDomEl(e)?e.attr("href",o):b("head").append('<link id="google-fonts" rel="stylesheet" type="text/css" href="'+o+'" />'),b("#gf-output").html(c[0].outerHTML),setTimeout(function(){MTautosize(document.querySelectorAll("textarea"))},100),this.save_font_settings()},resolve_api_data:function(e){var t,n=[],o=["sort"];for(t in e)if(e.hasOwnProperty(t)&&T.in_array(t,o)){var a=e[t];if(T.isDefined(a)){if(a===Object(a)){var i,r=a,s=[];for(i in r)r.hasOwnProperty(i)&&r[i]&&s.push(i);if(!s.length)continue;a=s.join(",")}n.push(t+"="+a)}}return n.join("&")},insert_font:function(e){var t=[],n=e.closest("li"),o=n.find(".font-name").text(),a=n.find("select[name=variant]").val().trim(),e=b("#controls").find("select[name=subset]").val(),n=!1;a&&"400"!==a&&(t.push(a),n=!0),e&&(n||t.push(a),t.push(e)),t.length&&(o=o+" ("+t.join(", ")+")"),i.insert_google_font&&i.insert_google_font(o)},handle_ajax_error:function(e,t){0==e.status?alert("Connection Error. Request Failed. Please Try again."):404==e.status?alert("Requested URL not found."):500==e.status?alert("Internel Server Error."):"parsererror"==t?alert("Error.\nParsing JSON Request failed."):"timeout"==t?alert("Request Timed out."):alert("Unknow Error.\n"+e.responseText)}};z.init()});