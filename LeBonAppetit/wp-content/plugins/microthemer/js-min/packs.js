jQuery(document).ready(function(s){var e=window.parent.TvrMT,l=e.TvrUi,a=e.TvrCom,i=(e.tvrsprintf,window.parent.TvrLang);l.templates=e.data.templates;var d={init:function(){e.data.prog.combo.packTypes=[i.theme_skin,i.plugin_skin,i.theme_scaffold,i.plugin_scaffold],this.jQueryVersion=a.getJQueryVersion(s.fn.jquery),this.jQueryUIVersion=a.getJQueryVersion(s.ui.version,!0),this.autocompleteUsesDivs="01.12.01"<=this.jQueryUIVersion,this.autocompleteUsesDivs?s("#tvr").addClass("autocompleteUsesDivs"):s("#tvr").addClass("autocompleteNoDivs"),e&&a.isDomEl(s("#update-packs-list"))&&l.update_packs_obj(s("#update-packs-list").attr("rel")),s("input.combobox").on("focus",function(){var t=s(this);t.autocomplete({source:e.data.prog.combo[t.attr("rel")],delay:0,minLength:0,appendTo:t.parent(".tvr-input-wrap"),open:function(e,a){t.next(".combo-arrow").addClass("on")},select:function(e,a){t.val(a.item.value),t.closest(".tvr-input-wrap").addClass("manual-val").find(".comp-style").addClass("hidden").end().find(".combo-arrow").removeClass("on"),"css_unit_set"===t.attr("id")&&(a=t.val(),t.closest("ul").find("input.custom_css_unit").val(a))},search:function(e,a){t.addClass("adjusted-corner-radius")},close:function(e,a){t.removeClass("adjusted-corner-radius").next(".combo-arrow").removeClass("on")}})}),s("span.combo-arrow").on("mousedown",function(){s(this).siblings(".ui-menu").is(":visible")&&(d.wasOpen=!0)}),s("span.combo-arrow").on("click",function(){var e=s(this),a=e.prev();d.wasOpen?(e.removeClass("on"),d.wasOpen=!1):(e.addClass("on"),a.focus().autocomplete("search",""))}),s("#tvr").on("click",function(e){var a,t=s(e.target);try{var o=(o=t.attr("class"))||"tvr-undefined"}catch(e){}0<=o.indexOf("pack-action")||0<=o.indexOf("pack-icon")||0<=o.indexOf("action-text")?(a=t.closest(".pack-action"),d.pack_button_action(a)):0<=o.indexOf("delete-pack-multi")?d.delete_pack(t,"multi"):0<=o.indexOf("download-pack-multi")?d.download_pack(t,"multi"):0<=o.indexOf("combobox")?d.combobox_clicked(t):0<=o.indexOf("delete-file")?d.delete_file(t,e):0<=o.indexOf("show-parent-dialog")?(l.show_dialog(t),"import-from-pack"==t.attr("rel")&&l.set_import_field(t.data("pack-name"))):0<=o.indexOf("close-dialog")||0<=o.indexOf("tvr-dialog")?d.close_dialog(t):0<=o.indexOf("fake-checkbox")||0<=o.indexOf("fake-radio")?d.toggle_radio_checkbox(t):0<=o.indexOf("upload-pack")?s("#upload_pack_input").val()||(alert(i.select_zip),e.preventDefault()):0<=o.indexOf("dialog-tab")&&o.indexOf("dialog-tabs")<0&&o.indexOf("dialog-tab-field")<0?d.dialog_tab_pressed(t):0<=o.indexOf("reveal-hidden-form-opts")?d.reveal_form_opts(t):0<=o.indexOf("save-preferences")&&d.save_preferences(t)})},escape_backslashes:function(e,a){return a?e.replace(/%5C/g,"%26%2392%3B"):e.replace(/\\/g,"&#92;")},save_preferences:function(e){var a=s("#ajaxUrl").attr("rel"),t=s("#returnUrl").attr("rel"),o=i.saving_preferences,n=d.escape_backslashes(s("#tvr-preferences").serialize(),!0);d.general_ajax_submission("Preferences save",a,t,o,"POST",n,e)},general_ajax_submission:function(e,a,t,o,n,r,i){s.ajax({type:n,url:a,data:r,timeout:l.tOut,error:function(e,a){s("img.ajax-loader").remove(),alert(d.handle_ajax_error(e,a))},success:function(){window.location=t}})},reveal_form_opts:function(e){var a=e.attr("rel");e.closest("li").siblings(".hidden."+a).addClass("show")},dialog_tab_pressed:function(e){var a=e.closest(".dialog-main"),t=a.find(".dialog-tabs"),e=e.attr("rel");d.update_tab(a,".dialog-tab-field",t,e,".dialog-tab",".dummy-for-now")},update_tab:function(e,a,t,o,n,r,i){t.find(n).removeClass("active").end().find(n+"-"+o).addClass("active").end().find(r).val(o),i||e.find(a+".show").removeClass("show").end().find(a+"-"+o).addClass("show")},combobox_clicked:function(e){e.autocomplete("search","").next(".combo-arrow").addClass("on")},pack_button_action:function(e){var a=e.attr("rel");"info"==a||"attachments"==a||"instructions"==a?(s("#main-theme-actions").find(".pack-action").removeClass("on"),s("#single-content-areas").find(".manage-content-wrap").removeClass("show"),s("#main-theme-actions").find("li.pack-action-"+a).addClass("on"),s("#edit-"+a).addClass("show")):"download"==a?d.download_pack(e,"single"):"delete"==a&&d.delete_pack(e,"single")},download_pack:function(e,a){var t=s("#zip-folder").attr("rel"),e=e.attr("data-dir-name"),o=t+e+".zip",e=s("#ajaxUrl").attr("rel")+"&mt_action=tvr_download_pack&dir_name="+e;s.ajax({type:"GET",url:e,async:!0,timeout:2e4,error:function(e,a){var t=s(l.templates.log_item).removeAttr("id");t.find(".short").text("Download failed").end().find(".long").html("<p>"+i.download_failed+"</p><p>"+d.handle_ajax_error(e,a)+"</p>"),s("#full-logs").html('<ul class="logs"></ul>').find("ul").append(t).focus()},success:function(e){var a=s(e).find("#microthemer-notice");"1"===s(e).find("#download-status").attr("rel")?location.href=o:s("#full-logs").html(a.html()).focus()},complete:function(){s("#loading-gif-active").remove()}})},delete_pack:function(t,o){if(!confirm(i.delete_pack_confirm))return!1;var n=t.attr("data-dir-name"),e=s("#ajaxUrl").attr("rel")+"&mt_action=tvr_delete_micro_theme&dir_name="+n,r=s("#delete-ok").attr("rel");s.ajax({type:"GET",url:e,async:!0,timeout:2e4,error:function(e,a){var t=s(l.templates.log_item).removeAttr("id");t.find(".short").text("Delete failed").end().find(".long").html("<p>"+i.delete_pack_failed+"</p><p>"+d.handle_ajax_error(e,a)+"</p>"),s("#full-logs").html('<ul class="logs"></ul>').find("ul").append(t).focus(),s("#loading-gif-active").remove()},success:function(e){var a=s(e).find("#microthemer-notice");"1"===s(e).find("#delete-status").attr("rel")?"single"==o?window.location=r:(s("#loading-gif-active").remove(),t.closest("li").fadeOut("slow"),(e=s("li.last-modified")).attr("rel")==n&&e.remove()):s("#full-logs").html(a.html()).focus()},complete:function(){}})},handle_ajax_error:function(e,a){return 0==e.status?i.error_connection:404==e.status?i.error_404:500==e.status?i.error_500:"parsererror"==a?i.error_parser:"timeout"==a?i.error_timeout:i.error_unknown+"\n"+e.responseText},export_zip_button:function(e,a){"warn"==s("span#external-notice").text()&&(confirm(i.external_notice)||a.preventDefault())},delete_file:function(e,a){confirm(i.delete_file_confirm)&&(window.location=e.attr("data-href"))},show_dialog:function(e){d.close_dialog()},close_dialog:function(){s("#tvr").find("div.tvr-dialog").removeClass("show")},toggle_radio_checkbox:function(e){var a=e.prev();if(a.is(":checked")){if(e.hasClass("fake-radio"))return!1;a.prop("checked",!1),e.removeClass("on")}else e.hasClass("fake-radio")&&e.closest(".fake-radio-parent").find('input[type="radio"]').prop("checked",!1).end().find(".fake-radio").removeClass("on"),a.prop("checked",!0),e.addClass("on")}};d.init(),s("#tvr-preferences").on("click",function(e){e=s(e.target);try{e.attr("class")}catch(e){}});var t={init:function(){s("#tvr-docs").on("click",function(e){e=s(e.target);try{var a=(a=e.attr("class"))||"tvr-undefined"}catch(e){}(0<=a.indexOf("css-group-heading")||0<=a.indexOf("accordion-menu-arrow")||0<=a.indexOf("pg-icon")||0<=a.indexOf("text-for-group"))&&(e=e.closest(".css-group-heading"),t.update_accordion(e,s("#tvr-docs")))})},update_accordion:function(e,a){a.find("li.accordion-item");var t,e=e.parent();return e.hasClass("show-content")&&(t=!0),a.find(".accordion-menu-arrow.on").removeClass("on"),a.find(".show-content").removeClass("show-content"),t||(e.find(".accordion-menu-arrow").addClass("on"),e.addClass("show-content")),!1}};t.init()});